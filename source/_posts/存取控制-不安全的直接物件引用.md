---
title: 存取控制 - 不安全的直接物件引用
date: 2024-08-04 16:28:36
tags: 網路漏洞
categories: 安全達人養成計劃研習
---
1. 漏洞定義：當應用程式根據使用者提供的輸入來存取物件時，攻擊者可以透過繞過授權要求直接存取系統中的資源。
2. 漏洞利用：攻擊者透過修改可存取參數的值（如使用者ID或個人資料），直接指向一個對象，從而利用這個漏洞。
3. 漏洞範例：文件中以一個個人財務追蹤應用程式（Finance Tracker App）為例，示範了沒有後端API的授權檢查如何導致不安全的直接物件參考。
4. 漏洞後果：任何登入的使用者都可以透過修改URL請求中的使用者ID參數來請求和存取其他使用者的個人資料。
5. 漏洞演示：文件中展示了攻擊者如何利用這個漏洞存取應用程式中其他使用者的財務資料。
6. 預防措施：
	- 確保行動裝置呼叫的後端API使用適當的存取控制來存取相關端點。
	- 如果適用，請對具有不同授權等級的使用者進行測試。
#### 例子:
```python
if request.user:

student_score_details = ExamScore.objects.get(id=score_id)
```
這段程式碼沒有顯示任何授權檢查，這意味著任何登入的使用者都可能存取任何分數記錄，只要他們知道或猜測到正確的 score_id。

```   python
student_score_details = ExamScore.objects.get(user=request.user, id=score_id)

```
確保只有當使用者要求自己的考試分數時，才能檢索到相應的記錄。透過將 user=request.user 作為查詢條件之一，它限制了查詢結果，只傳回目前登入使用者所擁有的考試分數記錄。
